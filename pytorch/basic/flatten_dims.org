#+begin_src python :results output
(Pdb++) tmp = torch.randint(1,4, (1, 2,3,4,5))
(Pdb++) tmp
tensor([[[[[3, 3, 1, 3, 2],
           [3, 2, 1, 3, 1],
           [2, 1, 2, 3, 3],
           [2, 2, 3, 1, 1]],

          [[3, 2, 3, 3, 3],
           [2, 2, 2, 1, 3],
           [2, 3, 3, 1, 3],
           [3, 3, 1, 3, 2]],

          [[3, 2, 3, 1, 3],
           [2, 2, 1, 1, 3],
           [3, 1, 2, 2, 2],
           [2, 3, 1, 3, 3]]],


         [[[2, 3, 3, 1, 1],
           [2, 1, 1, 2, 3],
           [2, 3, 1, 3, 2],
           [3, 1, 3, 1, 1]],

          [[3, 1, 1, 3, 2],
           [2, 3, 3, 2, 2],
           [1, 2, 3, 1, 3],
           [2, 2, 3, 3, 2]],

          [[3, 2, 1, 2, 3],
           [3, 1, 2, 3, 2],
           [3, 1, 3, 3, 2],
           [1, 2, 3, 2, 1]]]]])
(Pdb++) torch.flatten(tmp, 2).shape
torch.Size([1, 2, 60])
(Pdb++) torch.flatten(tmp, 2) # flatten from dim=2 to dim =-1
tensor([[[3, 3, 1, 3, 2, 3, 2, 1, 3, 1, 2, 1, 2, 3, 3, 2, 2, 3, 1, 1, 3, 2, 3,
          3, 3, 2, 2, 2, 1, 3, 2, 3, 3, 1, 3, 3, 3, 1, 3, 2, 3, 2, 3, 1, 3, 2,
          2, 1, 1, 3, 3, 1, 2, 2, 2, 2, 3, 1, 3, 3],
         [2, 3, 3, 1, 1, 2, 1, 1, 2, 3, 2, 3, 1, 3, 2, 3, 1, 3, 1, 1, 3, 1, 1,
          3, 2, 2, 3, 3, 2, 2, 1, 2, 3, 1, 3, 2, 2, 3, 3, 2, 3, 2, 1, 2, 3, 3,
          1, 2, 3, 2, 3, 1, 3, 3, 2, 1, 2, 3, 2, 1]]])
(Pdb++) torch.flatten(tmp, start_dim=2, end_dim=-1)
tensor([[[3, 3, 1, 3, 2, 3, 2, 1, 3, 1, 2, 1, 2, 3, 3, 2, 2, 3, 1, 1, 3, 2, 3,
          3, 3, 2, 2, 2, 1, 3, 2, 3, 3, 1, 3, 3, 3, 1, 3, 2, 3, 2, 3, 1, 3, 2,
          2, 1, 1, 3, 3, 1, 2, 2, 2, 2, 3, 1, 3, 3],
         [2, 3, 3, 1, 1, 2, 1, 1, 2, 3, 2, 3, 1, 3, 2, 3, 1, 3, 1, 1, 3, 1, 1,
          3, 2, 2, 3, 3, 2, 2, 1, 2, 3, 1, 3, 2, 2, 3, 3, 2, 3, 2, 1, 2, 3, 3,
          1, 2, 3, 2, 3, 1, 3, 3, 2, 1, 2, 3, 2, 1]]])
(Pdb++) torch.flatten(tmp, start_dim=2, end_dim=-1).shape
torch.Size([1, 2, 60])

(Pdb++) torch.flatten(tmp, 3).shape # flatten from dim=3 to dim=-1 (dim=4)
torch.Size([1, 2, 3, 20])

(Pdb++) torch.flatten(tmp, 1).shape
torch.Size([1, 120])
(Pdb++) torch.flatten(tmp, 1)
tensor([[3, 3, 1, 3, 2, 3, 2, 1, 3, 1, 2, 1, 2, 3, 3, 2, 2, 3, 1, 1, 3, 2, 3, 3,
         3, 2, 2, 2, 1, 3, 2, 3, 3, 1, 3, 3, 3, 1, 3, 2, 3, 2, 3, 1, 3, 2, 2, 1,
         1, 3, 3, 1, 2, 2, 2, 2, 3, 1, 3, 3, 2, 3, 3, 1, 1, 2, 1, 1, 2, 3, 2, 3,
         1, 3, 2, 3, 1, 3, 1, 1, 3, 1, 1, 3, 2, 2, 3, 3, 2, 2, 1, 2, 3, 1, 3, 2,
         2, 3, 3, 2, 3, 2, 1, 2, 3, 3, 1, 2, 3, 2, 3, 1, 3, 3, 2, 1, 2, 3, 2, 1]])
#+end_src
